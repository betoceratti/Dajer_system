<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4cd99373c2.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa&family=Goldman:wght@400;700&family=Inconsolata:wght@300&family=Montserrat:ital,wght@1,300&family=Orbitron:wght@500&family=Rubik:ital,wght@1,300&family=Space+Mono:ital@1&family=Teko:wght@500&family=Turret+Road:wght@500&display=swap" rel="stylesheet">
    <!-- JavaScript -->
    <script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

<!-- CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css"/>
<!-- Semantic UI theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/semantic.min.css"/>
<!-- Bootstrap theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css"/>
  </head>
  
  <style>
  
  .form-text{
  font-family:Comfortaa;
  font-size:13px;
  color: blue;
  
  }
  
  h3{
  font-family:Comfortaa;
  font-size:16px;
  color: blue;
  
  }
  
  .mensaje{
   color:#333EFF;
   font-size:25px;
   font-family:Montserrat;
   
  
  }
  
 .designer{
  font-size:15px;
  font-family: 'Orbitron', sans-serif;
  color:#808000;
  }

 </style>
  
  
  <body>
  
  <!--<div class="mensaje" id="mensaje"><h3 class="tittle">Pago sistema SICA pendiente!</h3></div>-->
  
    <form>
    <div class="input-group">
  
  <input type="date" aria-label="Fecha" class="form-control" id="fecha" required>
  
</div>
 <div class="input-group">
  
   <input type="number" aria-label="Importe" class="form-control" placeholder="$" id="importe" required>
</div>   
    
  <select class="form-select" aria-label="Default select example" id="selector1">
  <option selected>Categoria</option>
  <option value="GASTOS_ADMON">GASTOS_ADMON</option>
  <option value="GASTOS_DE_VENTA">GASTOS_DE_VENTA</option>
  <option value="SALIDA_AHORRO">SALIDA_AHORRO</option>
  </select>

  <select class="form-select" aria-label="Default select example" id="selector2">
  <option selected>Concepto</option>
  
  </select>

<div class="form-floating">
  <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea"></textarea>
  <label for="floatingTextarea">Captura la nota respectiva</label>
</div>
<br>
  <button  class="btn btn-primary" id="btn_entrar" onclick="add()">Guardar</button>
   <button  class="btn btn-danger" id="btn_close" onclick="cerrar()">Cerrar</button>
</form>
    <br>
   
    <h5 class="designer">System  by Roberto Ceratti</h5>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

  </body>
 

<script>

//FUNCION PARA ACCESAR AL SISTEMA CPN USUARIO Y PASSWORD

function clear(e){
  let fecha = document.getElementById("fecha");
  let importe = document.getElementById("importe");
  let categoria = document.getElementById("selector1");
  let concepto = document.getElementById("selector2");
  let nota = document.getElementById("floatingTextarea");
  let mensaje = document.getElementById("mensaje");
  fecha.value = "";
  importe.value = "";
  categoria.value = "";
  concepto.value ="";
  nota.value = "";
  mensaje.innerHTML = "El gasto se registro con exito!"
 
  };
  
  
  


function cerrar(e){
  //google.script.host.close();
  google.script.host.close();

};


//funcion para agragar los datos mediante correr Ã±a funcion de macros 
  function add(){
  let fecha = document.getElementById("fecha").value;
  let importe = document.getElementById("importe").value;
  let categoria = document.getElementById("selector1").value;
  let concepto = document.getElementById("selector2").value;
  let nota = document.getElementById("floatingTextarea").value;
  
  const data = {
  fecha : fecha,
  importe: importe,
  categoria: categoria,
  concepto: concepto,
  nota:nota
  
  
  };
  if(fecha != "" && importe >0 && categoria != "" && concepto != ""){
 
  google.script.run.withSuccessHandler(clear).gastosModal(data);
   alertify.success('Gasto contabilizado con exito!');
   //mostrarToast()
  
  }else{
   alertify.error('Completa los campos!');
  
  }
  
  
  };
  
  
 
  
 function opciones(){

 var admon = ["TELEFONO",
 "PAPELERIA",
 "COM BANCARIAS",
 "COMISIONES",
 "MANTENIMIENTO OFNA",
 "HONORARIOS",
 "APOYO SOCIOS",
 "SEGUROS",
 "SISTEMA MAN",
 "LIMPIEZA",
 "GASOLINA",
 "AGUINALDOS",
 "PAGO INTERESES",
 "IMPUESTOS",
 "MOBILIARIO",
 "CONDONACION INTERESES",
 "MANT EQUIPO COMPUTO"];
 
 var venta = ["PUBLICIDAD",
"ALIMENTOS",
"SUELDO EJECUTIVO",
"GAS MOTOS",
"SERV MOTOS",
"AGRADECIMIENTOS",
"COM X VENTAS",
"PAGO DE MOTOS",
"SERVICIOS",
"EJEC COBRANZA",
"RENTA DE SUC",
"TEL SUC"];


var ahorro=["Aplicacion Ahorro","Aplicacion Ahorro"];

 let categori = document.getElementById("selector1").value;
 let concept = document.getElementById("selector2");
 let nota = document.getElementById("nota");
 
 


if(categori == "GASTOS_ADMON"){
  var admon = admon;
  for(i=0; i<admon.length;i++){
  concept.options[i] = new Option(admon[i],admon[i]);
  }


 }else if(categori == "GASTOS_DE_VENTA"){
  //concept.innerHTML = "";
  var venta = venta;
  for(i=0; i<venta.length;i++){
  concept.options[i] = new Option(venta[i],venta[i]);
  }
 
  }else if(categori == "SALIDA_AHORRO"){
   var ahorro = ahorro;
  for(i=0; i<ahorro.length;i++){
  concept.options[i] = new Option(ahorro[i],ahorro[i]);
  }
 
 }
 
  };


function mostrarToast() {
    var toast = document.getElementById("mitoast");
    toast.className = "mostrar";
    setTimeout(function(){ toast.className = toast.className.replace("mostrar", ""); }, 5000);
};
  
//EVENTOS
 document.getElementById("selector1").addEventListener("change",opciones);


</script>

 
</html>





