<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/4cd99373c2.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa&family=Goldman:wght@400;700&family=Inconsolata:wght@300&family=Montserrat:ital,wght@1,300&family=Orbitron:wght@500&family=Rubik:ital,wght@1,300&family=Space+Mono:ital@1&family=Teko:wght@500&family=Turret+Road:wght@500&display=swap" rel="stylesheet">

   </head>
  
  <style>
  .contenedor{
  width:90%;
  display:flex;
  flex-direction: column;  
  flex-wrap: wrap;
  justify-content: center;  
  
  }
  
  input,select{
  margin-top: 15px;
  border-color: grey;
  font-size:15px;
   border-top-style: none;
  border-right-style: none;
  border-bottom-style: solid;
  border-left-style: none;
  
  }
  
  .btn_guardar{
  background: #4A33FF;
  color:white;
  width:25%;
  margin-top:30px;
  transition: .5s all ease;
  border-radius:5px;
  
   
  }
  
  .btn_guardar:hover{
   background: #070B5A;
  
  }
  
  
  .btn_cancelar{
  background: red;
  color:white;
  width:25%;
  margin-top:20px; 
  transition: .5s all ease;
  border-radius:5px;
   
  }
  
  .btn_cancelar:hover{
   background: #5A0724;
  
  }
  
  .mensaje{
   color:#333EFF;
   font-size:25px;
   font-family:Montserrat;
   
  
  }
  
  .nota{
  margin-top: 15px;
   }
  
  
  
  </style>
  <body>
  <h3 class="tittle">Captura de Gatos Dajer</h3>
  <div class="mensaje" id="mensaje">
  
  </div>
  <div class="contenedor">
 
  <input type="date" id="fecha" required>
  <input placeholder="$" type="number" id="importe"required>
  <select class="selector" id="selector1">
  <option value="SELECCIONA LA CATEGORIA" disabled selected>SELECCIONA LA CATEGORIA</option>
  <option value="GASTOS_ADMON">GASTOS_ADMON</option>
  <option value="GASTOS_DE_VENTA">GASTOS_DE_VENTA</option>
  <option value="SALIDA_AHORRO">SALIDA_AHORRO</option>
  </select>
  
  <select class="selector" id="selector2">
  <option value="SELECCIONA LA DESCRIPCION" disabled selected>SELECCIONA LA DESCRIPCION</option>
  
  
  </select>
  
  <textarea class="nota" id="nota" name="w3review" rows="4" cols="10" placeholder="Captura la nota respectiva"></textarea>
 
  </div>
  
   <button class="btn_guardar" id="btn_guardar">Guardar</button>
  <button class="btn_cancelar" id="close">Cerrar</button>
  <!--<button class="btn_cargar" id="cargar">Cargar</button>-->
   
  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    
  </body>
  
  
  <script>
  function alerta(){
  google.script.run.mensaje();
  
  }
  
  
   function closeModal(e){
    google.script.host.close();
    
    };
  
 
  
  function clear(e){
  let fecha = document.getElementById("fecha");
  let importe = document.getElementById("importe");
  let categoria = document.getElementById("selector1");
  let concepto = document.getElementById("selector2");
  let nota = document.getElementById("nota");
  let mensaje = document.getElementById("mensaje");
  fecha.value = "";
  importe.value = "";
  categoria.value = "";
  concepto.value ="";
  nota.value = "";
  mensaje.innerHTML = "El gasto se registro con exito!"
  };
  
  
 
  
  //FUNCION PARA CREAR OPCIOINES EN EL SELECT
  
 function opciones(){
 var admon = ["TELEFONO",
 "PAPELERIA",
 "COM BANCARIAS",
 "COMISIONES",
 "MANTENIMIENTO OFNA",
 "HONORARIOS",
 "APOYO SOCIOS",
 "SEGUROS",
 "SISTEMA MAN",
 "LIMPIEZA",
 "GASOLINA",
 "AGUINALDOS",
 "PAGO INTERESES",
 "IMPUESTOS",
 "MOBILIARIO"];
 
 var venta = ["PUBLICIDAD",
"ALIMENTOS",
"SUELDO EJECUTIVO",
"GAS MOTOS",
"SERV MOTOS",
"AGRADECIMIENTOS",
"COM X VENTAS",
"PAGO DE MOTOS",
"SERVICIOS",
"EJEC COBRANZA",
"RENTA DE SUC",
"TEL SUC"];


var ahorro=["Aplicacion Ahorro","Aplicacion Ahorro"];

 let categori = document.getElementById("selector1").value;
 let concept = document.getElementById("selector2");
 let nota = document.getElementById("nota");
 
 
//nota.innerHTML = categori;

if(categori == "GASTOS_ADMON"){
  var admon = admon;
  for(i=0; i<admon.length;i++){
  concept.options[i] = new Option(admon[i],admon[i]);
  }


 }else if(categori == "GASTOS_DE_VENTA"){
  //concept.innerHTML = "";
  var venta = venta;
  for(i=0; i<venta.length;i++){
  concept.options[i] = new Option(venta[i],venta[i]);
  }
 
  }else if(categori == "SALIDA_AHORRO"){
   var ahorro = ahorro;
  for(i=0; i<ahorro.length;i++){
  concept.options[i] = new Option(ahorro[i],ahorro[i]);
  }
 
 }
 
  };

  
  
  //funcion para agragar los datos mediante correr Ã±a funcion de macros 
  function add(){
  let fecha = document.getElementById("fecha").value;
  let importe = document.getElementById("importe").value;
  let categoria = document.getElementById("selector1").value;
  let concepto = document.getElementById("selector2").value;
  let nota = document.getElementById("nota").value;
  
  const data = {
  fecha : fecha,
  importe: importe,
  categoria: categoria,
  concepto: concepto,
  nota:nota
  
  
  };
  if(fecha != "" && importe >0 && categoria != "" && concepto != ""){
 
  google.script.run.withSuccessHandler(clear).gastosModal(data);
  
  }
  
  
  };
  
  document.getElementById("close").addEventListener("click",closeModal);
  document.getElementById("btn_guardar").addEventListener("click",add);
  //document.getElementById("cargar").addEventListener("click",opciones);
  document.getElementById("selector1").addEventListener("change",opciones);
  
  
  
  
  </script>
</html>

 <!--concept.options[i] = new Option(admon[i],"valor:" + i);concept.options[i].text =admon[i];
  concept.options[i].value =admon[i]; for(i=0; i<admon.length;i++){
  concept.options[i] = new Option(admon[i],admon[i]);

 }-->